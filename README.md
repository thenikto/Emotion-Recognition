# Emotion Recognition (ResNet50 + MTCNN)
Проект по распознаванию эмоций с помощью модели глубокого обучения.

Обучение модели реализовано в файле `train.ipynb`. В качестве основы используется предобученная модель ResNet50, обученная на датасете ImageNet.
Последний полносвязный слой модели дообучается под нашу задачу классификации эмоций.

В качестве датасета для обучения используется FER-2013. https://www.kaggle.com/datasets/msambare/fer2013 Задача модели: определить, какая эмоция изображена на лице, и отнести её к одному из семи классов: Angry, Disgust, Fear, Happy, Sad, Surprise или Neutral.

В датасете есть выраженный дисбаланс классов. Для классов, где изображений меньше, дополнительно генерируются аугментированные изображения. Для этого реализован кастомный датасет, который применяет различные преобразования к исходным изображениям. Оригинальные и аугментированные данные объединяются в единый сбалансированный датасет.

После завершения обучения строится матрица ошибок (confusion matrix), позволяющая визуально оценить качество классификации по каждому классу. Итоговые веса модели сохраняются в файл `emotion_resnet50_balanced.pth`.

Файл web_recognition.py нужен для того, чтобы запустить уже обученную модель и проверить её работу используя веб-камеру. 
Для детекции лиц используется MTCNN. На каждом кадре выполняется детекция лиц, после чего найденные области обрезаются и проходят ту же предобработку, которая использовалась при обучении: изменение размера, перевод в grayscale, нормализация и преобразование в тензор.

Для стабильности результата используется буфер из последних пяти предсказаний. Итоговая эмоция определяется как наиболее часто встречающаяся в этом буфере, что позволяет сгладить случайные колебания между кадрами. Результат отображается поверх изображения в виде прямоугольника вокруг лица и подписи с распознанной эмоцией.

